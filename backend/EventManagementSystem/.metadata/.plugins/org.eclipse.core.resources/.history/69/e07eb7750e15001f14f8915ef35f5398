package com.eventmangementsystem.service;

import java.util.List;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import com.eventmangementsystem.dao.BookingDAO;
import com.eventmangementsystem.dao.EventDAO;
import com.eventmangementsystem.entity.Booking;
import com.eventmangementsystem.entity.Event;

@Service
public class BookingService {
    @Autowired
    private BookingDAO bookingDAO;

    @Autowired
    private EventDAO eventDAO;

    public List<Booking> getAllBookings() {
        return bookingDAO.getAllBookings();
    }

    public Booking getBooking(int bookingId) {
        return bookingDAO.getBooking(bookingId);
    }

    public void createBooking(Booking booking, int eventId) {
        Event event = eventDAO.getEvent(eventId); // Fetch the event by ID
        if (event != null) {
            booking.setEvent(event); // Set the event to the booking
            bookingDAO.createBooking(booking); // Save the booking
        } else {
            throw new IllegalArgumentException("Invalid event ID");
        }
    }

    public Booking updateBooking(int bookingId, Booking updatedBooking) {
        Booking existingBooking = bookingDAO.getBooking(bookingId);
        if (existingBooking != null) {
            // Update fields of the existing booking
            existingBooking.setCustomername(updatedBooking.getCustomername());
            existingBooking.setNumberoftickets(updatedBooking.getNumberoftickets());
            existingBooking.setBookingstatus(updatedBooking.isBookingstatus());
            existingBooking.setRole(updatedBooking.getRole());

            // Update other fields as needed
            return bookingDAO.updateBooking(existingBooking);
        }
        return null; // Or throw an exception
    }

    public void removeBooking(int bookingId) {
        bookingDAO.removeBooking(bookingId);
    }
}



//package com.eventmangementsystem.service;
//
//import java.util.List;
//
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.stereotype.Service;
//
//import com.eventmangementsystem.dao.BookingDAO;
//import com.eventmangementsystem.entity.Booking;
//
//
//@Service
//public class BookingService {
//    @Autowired
//    private BookingDAO bookingDAO;
//
//    public List<Booking> getAllBookings() {
//        return bookingDAO.getAllBookings();
//    }
//
//    public Booking getBooking(int bookingId) {
//        return bookingDAO.getBooking(bookingId);
//    }
//
//    public void createBooking(Booking booking) {
//    	bookingDAO.createBooking(booking);
//    }
//
//    public Booking updateBooking(int eventId, Booking updatedBooking) {
//        Booking existingBooking = bookingDAO.getBooking(eventId);
//        if (existingBooking != null) {
//            // Update fields of the existing event
//        	existingBooking.setCustomername(updatedBooking.getCustomername());
//        	existingBooking.setNumberoftickets(updatedBooking.getNumberoftickets());
//        	//existingBooking.setTicketPrice(updatedEvent.getTicketPrice());
//            // Update other fields as needed
//
//            // Delegate saving to DAO
//            return bookingDAO.updateBooking(existingBooking);
//        }
//        return null; // Or throw an exception
//    }
//
//    public void removeBooking(int eventId) {
//    	bookingDAO.removeBooking(eventId);
//    }
//}